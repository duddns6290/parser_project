# OCR 계근지 / 계량증명서 파싱

OCR 결과(JSON)를 입력으로 받아
계근지 / 계량증명서 내 주요 정보를
노이즈에 강하게 파싱하여 구조화된 JSON 형태로 출력하는 파서입니다.

본 프로젝트는 외부 NLP 또는 ML 라이브러리에 의존하지 않고
규칙 기반 파싱과 휴리스틱 추론만으로 구현되었습니다.


## 실행 방법 (로컬 재현 가능)

실행 환경
- Python 3.9 이상
- Windows, macOS, Linux 모두 가능

프로젝트 구조
parser_project/
- main.py          실행 진입점
- parser.py        파싱 메인 로직
- normalize.py     텍스트 및 숫자 정규화
- rules.py         정규식 및 휴리스틱 규칙
- README.md

실행 절차
1. OCR JSON 샘플 폴더를 프로젝트 루트에 위치
   기본 폴더명: [2026 ICT_리코] smaple_data_ocr

2. 프로젝트 루트에서 실행
python main.py

3. 실행 완료 후 결과 파일 생성
output/result.json


## 의존성 / 환경

- Python 표준 라이브러리만 사용
  re
  json
  pathlib
  difflib

외부 패키지 설치가 필요 없으며
동일한 입력에 대해 항상 동일한 결과를 재현할 수 있습니다.


## 설계 및 주요 가정

OCR 텍스트는 다음과 같은 노이즈를 포함한다고 가정합니다.

- 띄어쓰기 불규칙
- 문자 오인식 (O → 0, l/I → 1)
- 필드 순서 변경
- 라벨 누락
- 숫자 포맷 불규칙 (콤마, 공백, 단위 변형 등)

이를 고려하여 파싱 로직을 다음 단계로 설계하였습니다.

정규화(normalize)
라벨 기반 추출(rule)
라벨 누락 대비 휴리스틱 추론
중량 관계 검증(gross - tare = net)


## 주요 파싱 전략

텍스트 정규화
- 불필요한 공백 및 특수문자 제거
- OCR 숫자 오탈자 보정
  O, o → 0
  l, I → 1
- 회사명 표기 정규화
  ( 주 ) → (주)
  글자 단위 공백 제거

라벨 기반 파싱
- 계량일자, 차량번호, 거래처, 실중량 등
  사전에 정의된 라벨 후보를 기반으로 값 추출
- 콜론 유무와 관계없이 라벨 뒤 값 추정

라벨 누락 대응
- 날짜는 전체 텍스트에서 패턴 탐색
- 거래처는 귀하 표현 활용
- 발급기관은 (주) 포함 여부 및 문서 하단 휴리스틱 추정

중량 추론 및 검증
- OCR 텍스트 전체에서 중량 후보 수집
- gross - tare = net 관계 성립 여부로 역할 추론
- 검증 결과를 validation 필드에 기록



## 한계 및 개선 아이디어

- 중량 값이 2개 이하인 문서에서는
  gross, tare, net 역할을 정확히 추론하기 어려울 수 있음
- 거래처 또는 발급기관이 문장 내부에만 존재하는 경우
  규칙 기반 추론 정확도가 낮아질 수 있음
- 문서 유형이 다양해질 경우
  라벨 사전 및 휴리스틱 규칙 확장이 필요함

향후 데이터 규모가 커지거나 문서 유형이 확장될 경우
선택적으로 ML 기반 보완 모듈을 추가하는 것도 가능함
